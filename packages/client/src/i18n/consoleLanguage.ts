export type ConsoleLanguage = 'en' | 'zh';

export const CONSOLE_LANGUAGE_STORAGE_KEY = 'vk-console-language';

const CONSOLE_LANGUAGE_COPY = {
  en: {
    language: {
      switchButtonLabel: '中文',
      switchButtonAria: 'Switch language',
    },
    app: {
      board: 'Board',
      memory: 'Memory',
      manageProjects: 'Manage projects',
      loading: 'loading...',
      newTaskHint: "Create new task (Press 'c')",
      workspaceSwitchConfirm:
        'Switch workspace? Running tasks will continue in the background and are only visible when you return to the original workspace.',
      gatewayLabels: {
        socket: 'Socket',
        restApi: 'REST API',
        worker: 'Worker',
        dataDir: 'Data Dir',
      },
    },
    workspaceEntry: {
      title: 'Workspace Entry',
      subtitle: 'Choose a workspace, then continue into the app shell.',
      staleWorkspaceNotice: 'Previously selected workspace is no longer available.',
      refresh: 'Refresh',
      workspaceLabel: 'Workspace',
      workspaceSelectPlaceholder: 'Select workspace',
      continue: 'Continue to workspace',
      createWorkspaceTitle: 'Create Workspace',
      hostLabel: 'Host',
      hostSelectPlaceholder: 'Select host',
      hostAutoNote: 'Auto-discovered hosts. If unavailable, use manual host ID below.',
      manualHostLabel: 'Manual Host ID',
      workspaceNameLabel: 'Workspace Name',
      rootPathLabel: 'Root Path',
      createWorkspace: 'Create workspace',
      deleteWorkspaceTitle: 'Delete Workspace',
      deleteWorkspaceNote: 'Type the exact workspace name to confirm deletion.',
      deleteWorkspaceInputLabel: 'Type workspace name to confirm deletion',
      deleteWorkspaceInputPlaceholder: 'Select workspace first',
      deleteWorkspaceButtonAria: 'Delete workspace',
      deleteWorkspace: 'Delete workspace',
      projectsTitle: 'Workspace Projects',
      projectsNote: 'Manage projects under the selected workspace.',
      fieldRequiredHint: 'required',
      fieldOptionalHint: 'optional',
      workspaceRootPathDisplay: 'Workspace Root Path',
      projectPathAutoLabel: 'Project Local Path (auto)',
      projectPathAutoNote: 'Generated under workspace root based on project name.',
      discoverProjects: 'Discover projects',
      projectNameLabel: 'Project Name',
      projectLocalPathLabel: 'Project Local Path',
      defaultBranchLabel: 'Default Branch',
      remoteUrlLabel: 'Remote URL',
      createProject: 'Create project',
      discoveredTitle: 'Discovered Repositories',
      discoveredNote: 'Results from workspace root scan.',
      discoveredEmpty: 'No discovered repositories yet.',
      registeredTag: 'Registered',
      registeredProjectsCount: 'Registered projects in this workspace:',
      errors: {
        workspaceNameRequired: 'Workspace name is required.',
        workspaceRootPathRequired: 'Workspace root path is required.',
        hostRequired: 'Please choose a host or enter a manual host ID.',
        selectWorkspaceFirst: 'Select a workspace first.',
        projectNameRequired: 'Project name is required.',
        projectLocalPathRequired: 'Project local path is required.',
        projectNameInvalid: 'Project name cannot contain path separators.',
        workspaceRootUnavailable: 'Workspace root path is unavailable.',
        selectWorkspaceToDelete: 'Select a workspace to delete.',
        workspaceDeleteNameMismatch: 'Workspace name confirmation does not match.',
      },
    },
    memory: {
      title: 'Memory',
      refresh: 'Refresh',
      newMemory: 'New Memory',
      dismiss: 'Dismiss',
      settingsTitle: 'Settings',
      filterTitle: 'Filter',
      hostId: 'Host ID',
      projectId: 'Project ID',
      scope: 'Scope',
      kind: 'Kind',
      kindOptions: {
        preference: 'preference',
        constraint: 'constraint',
        fact: 'fact',
        workflow: 'workflow',
      },
      search: 'Search',
      enabledOnly: 'Enabled Only',
      all: 'all',
      project: 'project',
      host: 'host',
      prev: 'Prev',
      next: 'Next',
      page: 'Page',
      createMemory: 'Create Memory',
      editMemory: 'Edit Memory',
      emptyList: 'No memory items matched the current filter.',
      pinned: 'pinned',
      disabled: 'disabled',
      editMemoryItem: 'Edit memory item',
      deleteMemoryItem: 'Delete memory item',
      metaHost: 'host',
      metaProject: 'project',
      metaSource: 'source',
      metaConfidence: 'confidence',
      metaHits: 'hits',
      metaUpdated: 'updated',
      registeredProjectsCount: 'Registered projects in this workspace:',
      settingsPanel: {
        noSettings: 'No memory settings loaded.',
        enabled: 'Enabled',
        gatewayStore: 'Gateway Store',
        rustStore: 'Rust Store',
        autoWrite: 'Auto Write',
        promptInjection: 'Prompt Injection',
        llmExtractFallback: 'LLM Extract Fallback',
        tokenBudget: 'Token Budget',
        retrievalTopK: 'Retrieval Top K',
        saveSettings: 'Save Settings',
      },
      editor: {
        hostId: 'Host ID',
        projectId: 'Project ID',
        projectIdPlaceholder: 'Optional for scope=host',
        scope: 'Scope',
        kind: 'Kind',
        tags: 'Tags (comma separated)',
        confidence: 'Confidence (0-1)',
        content: 'Content',
        contentPlaceholder: 'Durable memory content...',
        pinned: 'Pinned',
        enabled: 'Enabled',
        cancel: 'Cancel',
        createMemory: 'Create Memory',
        updateMemory: 'Update Memory',
      },
    },
  },
  zh: {
    language: {
      switchButtonLabel: 'EN',
      switchButtonAria: '切换语言',
    },
    app: {
      board: '看板',
      memory: '记忆',
      manageProjects: '项目管理',
      loading: '加载中...',
      newTaskHint: '创建新任务（快捷键 c）',
      workspaceSwitchConfirm: '切换工作区？正在运行的任务会在后台继续，仅在你回到原工作区时可见。',
      gatewayLabels: {
        socket: 'Socket',
        restApi: 'REST 接口',
        worker: '执行主机',
        dataDir: '数据目录',
      },
    },
    workspaceEntry: {
      title: '工作区入口',
      subtitle: '先选择工作区，再进入应用界面。',
      staleWorkspaceNotice: '之前选择的工作区已不可用。',
      refresh: '刷新',
      workspaceLabel: '工作区',
      workspaceSelectPlaceholder: '请选择工作区',
      continue: '进入工作区',
      createWorkspaceTitle: '创建工作区',
      hostLabel: '主机',
      hostSelectPlaceholder: '请选择主机',
      hostAutoNote: '自动发现在线主机。如不可用，可在下方手动输入主机 ID。',
      manualHostLabel: '手动主机 ID',
      workspaceNameLabel: '工作区名称',
      rootPathLabel: '根路径',
      createWorkspace: '创建工作区',
      deleteWorkspaceTitle: '删除工作区',
      deleteWorkspaceNote: '请输入完整工作区名称以确认删除。',
      deleteWorkspaceInputLabel: '输入工作区名称确认删除',
      deleteWorkspaceInputPlaceholder: '请先选择工作区',
      deleteWorkspaceButtonAria: '删除工作区',
      deleteWorkspace: '删除工作区',
      projectsTitle: '工作区项目',
      projectsNote: '管理当前工作区下的项目。',
      fieldRequiredHint: '必填',
      fieldOptionalHint: '选填',
      workspaceRootPathDisplay: '工作区根路径',
      projectPathAutoLabel: '项目本地路径（自动）',
      projectPathAutoNote: '根据项目名称自动拼接到工作区根路径下。',
      discoverProjects: '扫描项目',
      projectNameLabel: '项目名称',
      projectLocalPathLabel: '项目本地路径',
      defaultBranchLabel: '默认分支',
      remoteUrlLabel: '远端地址',
      createProject: '创建项目',
      discoveredTitle: '扫描到的仓库',
      discoveredNote: '来自工作区根目录扫描结果。',
      discoveredEmpty: '暂未扫描到仓库。',
      registeredTag: '已注册',
      registeredProjectsCount: '当前工作区已注册项目数：',
      errors: {
        workspaceNameRequired: '工作区名称不能为空。',
        workspaceRootPathRequired: '工作区根路径不能为空。',
        hostRequired: '请选择主机或输入手动主机 ID。',
        selectWorkspaceFirst: '请先选择工作区。',
        projectNameRequired: '项目名称不能为空。',
        projectLocalPathRequired: '项目本地路径不能为空。',
        projectNameInvalid: '项目名称不能包含路径分隔符。',
        workspaceRootUnavailable: '工作区根路径不可用。',
        selectWorkspaceToDelete: '请选择要删除的工作区。',
        workspaceDeleteNameMismatch: '工作区名称不匹配，无法删除。',
      },
    },
    memory: {
      title: '记忆',
      refresh: '刷新',
      newMemory: '新建记忆',
      dismiss: '关闭',
      settingsTitle: '设置',
      filterTitle: '筛选',
      hostId: '主机 ID',
      projectId: '项目 ID',
      scope: '作用域',
      kind: '类型',
      kindOptions: {
        preference: '偏好',
        constraint: '约束',
        fact: '事实',
        workflow: '流程',
      },
      search: '搜索',
      enabledOnly: '仅启用项',
      all: '全部',
      project: '项目',
      host: '主机',
      prev: '上一页',
      next: '下一页',
      page: '第',
      createMemory: '创建记忆',
      editMemory: '编辑记忆',
      emptyList: '当前筛选条件下没有匹配的记忆项。',
      pinned: '置顶',
      disabled: '已禁用',
      editMemoryItem: '编辑记忆项',
      deleteMemoryItem: '删除记忆项',
      metaHost: '主机',
      metaProject: '项目',
      metaSource: '来源',
      metaConfidence: '置信度',
      metaHits: '命中次数',
      metaUpdated: '更新时间',
      registeredProjectsCount: '当前工作区已注册项目数：',
      settingsPanel: {
        noSettings: '未加载记忆设置。',
        enabled: '启用',
        gatewayStore: '网关存储',
        rustStore: 'Rust 存储',
        autoWrite: '自动写入',
        promptInjection: '提示注入',
        llmExtractFallback: 'LLM 抽取兜底',
        tokenBudget: 'Token 预算',
        retrievalTopK: '检索 Top K',
        saveSettings: '保存设置',
      },
      editor: {
        hostId: '主机 ID',
        projectId: '项目 ID',
        projectIdPlaceholder: '当作用域为主机时可选',
        scope: '作用域',
        kind: '类型',
        tags: '标签（逗号分隔）',
        confidence: '置信度（0-1）',
        content: '内容',
        contentPlaceholder: '可长期复用的记忆内容...',
        pinned: '置顶',
        enabled: '启用',
        cancel: '取消',
        createMemory: '创建记忆',
        updateMemory: '更新记忆',
      },
    },
  },
} as const;

export const readStoredConsoleLanguage = (): ConsoleLanguage => {
  if (typeof window === 'undefined') {
    return 'en';
  }

  return window.localStorage.getItem(CONSOLE_LANGUAGE_STORAGE_KEY) === 'zh' ? 'zh' : 'en';
};

export const storeConsoleLanguage = (language: ConsoleLanguage): void => {
  if (typeof window === 'undefined') {
    return;
  }

  window.localStorage.setItem(CONSOLE_LANGUAGE_STORAGE_KEY, language);
};

export const toggleConsoleLanguage = (language: ConsoleLanguage): ConsoleLanguage =>
  language === 'en' ? 'zh' : 'en';

export const getConsoleLanguageCopy = (language: ConsoleLanguage) =>
  CONSOLE_LANGUAGE_COPY[language];
